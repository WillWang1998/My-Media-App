{"ast":null,"code":"import _regeneratorRuntime from\"/Users/willwang98/Rice Homework/final-frontend-WillWang1998/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/willwang98/Rice Homework/final-frontend-WillWang1998/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/willwang98/Rice Homework/final-frontend-WillWang1998/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{memo,useEffect,useState}from\"react\";import{Card,List,Input,Divider,message}from\"antd\";import{showBackendMessage,stringArrayEqual}from\"../util/Functions\";import EventBus from\"../util/EventBus\";import Following from\"./Following\";import{CloseCircleOutlined,PlusCircleOutlined}from\"@ant-design/icons\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Followings=function Followings(){message.config({rtl:false});var _useState=useState([]),_useState2=_slicedToArray(_useState,2),followings=_useState2[0],setFollowings=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),searchUserList=_useState4[0],setSearchUserList=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showSearchUserList=_useState6[0],setShowSearchUserList=_useState6[1];var load=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"http://localhost:4000/following\",{method:\"GET\",credentials:\"include\"}).then(function(res){if(res.ok){showBackendMessage();return res.json();}else{throw res.statusText;}}).then(function(res){setFollowings(function(followings){return res.followings;});}).catch(function(err){return message.error(err,1);});case 2:case\"end\":return _context.stop();}}},_callee);}));return function load(){return _ref.apply(this,arguments);};}();useEffect(function(){return load();},[]);var showSearchResult=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(value){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(value===\"\")){_context2.next=5;break;}setShowSearchUserList(false);setSearchUserList([]);_context2.next=8;break;case 5:setShowSearchUserList(true);_context2.next=8;return fetch(\"http://localhost:4000/following/search\",{method:\"POST\",credentials:\"include\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({keyWord:value})}).then(function(res){if(res.ok){showBackendMessage();return res.json();}else{throw res.statusText;}}).then(function(res){setSearchUserList(function(searchUserList){return res.searchResult;});}).catch(function(err){return message.error(err,1);});case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function showSearchResult(_x){return _ref2.apply(this,arguments);};}();var addNewFollowing=function addNewFollowing(value){return/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetch(\"http://localhost:4000/following/\"+value,{method:\"PUT\",credentials:\"include\"}).then(function(res){if(res.ok){showBackendMessage();return res.json();}else{throw res.statusText;}}).then(function(res){message.success(\"Added a new following user\");setFollowings(function(followings){return res.followings;});setSearchUserList(function(searchUserList){return searchUserList.filter(function(item){return item!==value;});});EventBus.dispatchEvent(\"reload_articles\");}).catch(function(err){return message.error(err,1);});case 2:case\"end\":return _context3.stop();}}},_callee3);}));};var deleteFollowing=function deleteFollowing(value){return/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return fetch(\"http://localhost:4000/following/\"+value,{method:\"DELETE\",credentials:\"include\"}).then(function(res){if(res.ok){showBackendMessage();return res.json();}else{throw res.statusText;}}).then(function(){message.success(\"Delete a followed user\");setFollowings(function(followings){return followings.filter(function(item){return item!==value;});});EventBus.dispatchEvent(\"reload_articles\");}).catch(function(err){return message.error(err,1);});case 2:case\"end\":return _context4.stop();}}},_callee4);}));};var MemoList=function MemoList(props){return/*#__PURE__*/_jsx(List,{dataSource:props.userList,renderItem:function renderItem(item){return/*#__PURE__*/_jsx(Following,{username:item,action:props.action,actionSymbol:props.symbol});},pagination:{position:\"bottom\",pageSize:5}});};var areEqualMemoList=function areEqualMemoList(prevProps,nextProps){return stringArrayEqual(prevProps.commentIdList,nextProps.commentIdList);};/*#__PURE__*/memo(MemoList,areEqualMemoList);return/*#__PURE__*/_jsxs(Card,{bordered:true,children:[/*#__PURE__*/_jsx(Divider,{orientation:\"left\",children:\"My followings\"}),/*#__PURE__*/_jsx(Input.Search,{allowClear:true,enterButton:\"Search\",size:\"large\",onSearch:showSearchResult}),/*#__PURE__*/_jsx(\"div\",{hidden:!showSearchUserList,children:/*#__PURE__*/_jsx(Card,{bordered:true,children:/*#__PURE__*/_jsx(MemoList,{userList:searchUserList,symbol:/*#__PURE__*/_jsx(PlusCircleOutlined,{}),action:addNewFollowing})})}),/*#__PURE__*/_jsx(MemoList,{userList:followings,symbol:/*#__PURE__*/_jsx(CloseCircleOutlined,{}),action:deleteFollowing})]});};export default Followings;","map":{"version":3,"sources":["/Users/willwang98/Rice Homework/final-frontend-WillWang1998/src/component/Followings.js"],"names":["React","memo","useEffect","useState","Card","List","Input","Divider","message","showBackendMessage","stringArrayEqual","EventBus","Following","CloseCircleOutlined","PlusCircleOutlined","Followings","config","rtl","followings","setFollowings","searchUserList","setSearchUserList","showSearchUserList","setShowSearchUserList","load","fetch","method","credentials","then","res","ok","json","statusText","catch","err","error","showSearchResult","value","headers","body","JSON","stringify","keyWord","searchResult","addNewFollowing","success","filter","item","dispatchEvent","deleteFollowing","MemoList","props","userList","action","symbol","position","pageSize","areEqualMemoList","prevProps","nextProps","commentIdList"],"mappings":"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","sourcesContent":["import React, {memo, useEffect, useState} from \"react\";\nimport {Card, List, Input, Divider, message} from \"antd\";\nimport {showBackendMessage, stringArrayEqual} from \"../util/Functions\";\nimport EventBus from \"../util/EventBus\";\nimport Following from \"./Following\";\nimport {CloseCircleOutlined, PlusCircleOutlined} from \"@ant-design/icons\";\n\nconst Followings = () => {\n\n    message.config({\n        rtl: false,\n    });\n    const [followings, setFollowings] = useState([]);\n    const [searchUserList, setSearchUserList] = useState([]);\n    const [showSearchUserList, setShowSearchUserList] = useState(false);\n\n    const load = async () => {\n        await fetch(\"http://localhost:4000/following\", {\n            method: \"GET\",\n            credentials: \"include\",\n        }).then(res => {\n            if (res.ok) {\n                showBackendMessage();\n                return res.json();\n            } else {\n                throw res.statusText;\n            }\n        }).then(res => {\n            setFollowings(followings => res.followings);\n        }).catch(err => message.error(err, 1));\n    };\n\n    useEffect(() => load(), []);\n\n    const showSearchResult = async (value) => {\n        if (value === \"\") {\n            setShowSearchUserList(false);\n            setSearchUserList([]);\n        } else {\n            setShowSearchUserList(true);\n            await fetch(\"http://localhost:4000/following/search\", {\n                method: \"POST\",\n                credentials: \"include\",\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                },\n                body: JSON.stringify({\n                    keyWord: value,\n                }),\n            }).then(res => {\n                if (res.ok) {\n                    showBackendMessage();\n                    return res.json();\n                } else {\n                    throw res.statusText;\n                }\n            }).then(res => {\n                setSearchUserList(searchUserList => res.searchResult);\n            }).catch(err => message.error(err, 1));\n        }\n    }\n\n    const addNewFollowing = (value) => async () => {\n        await fetch(\"http://localhost:4000/following/\" + value, {\n            method: \"PUT\",\n            credentials: \"include\",\n        }).then(res => {\n            if (res.ok) {\n                showBackendMessage();\n                return res.json();\n            } else {\n                throw res.statusText;\n            }\n        }).then(res => {\n            message.success(\"Added a new following user\");\n            setFollowings(followings => res.followings);\n            setSearchUserList(searchUserList => searchUserList.filter(item => item !== value));\n            EventBus.dispatchEvent(\"reload_articles\");\n        }).catch(err => message.error(err, 1));\n    };\n\n    const deleteFollowing = (value) => async () => {\n        await fetch(\"http://localhost:4000/following/\" + value, {\n            method: \"DELETE\",\n            credentials: \"include\",\n        }).then(res => {\n            if (res.ok) {\n                showBackendMessage();\n                return res.json();\n            } else {\n                throw res.statusText;\n            }\n        }).then(() => {\n            message.success(\"Delete a followed user\");\n            setFollowings(followings => followings.filter(item => item !== value));\n            EventBus.dispatchEvent(\"reload_articles\");\n        }).catch(err => message.error(err, 1));\n    };\n\n    const MemoList = (props) => {\n        return (\n            <List\n                dataSource={props.userList}\n                renderItem={(item) => <Following\n                    username={item}\n                    action={props.action}\n                    actionSymbol={props.symbol}\n                />}\n                pagination={{\n                    position: \"bottom\",\n                    pageSize: 5\n                }}\n            />\n        )\n    }\n\n    const areEqualMemoList = (prevProps, nextProps) => {\n        return stringArrayEqual(prevProps.commentIdList, nextProps.commentIdList);\n    }\n\n    memo(MemoList, areEqualMemoList);\n\n    return (\n        <Card bordered={true}>\n            <Divider orientation=\"left\">My followings</Divider>\n            <Input.Search\n                allowClear\n                enterButton=\"Search\"\n                size=\"large\"\n                onSearch={showSearchResult}\n            />\n            <div hidden={!showSearchUserList}>\n                <Card bordered={true}>\n                    <MemoList userList={searchUserList} symbol={<PlusCircleOutlined />} action={addNewFollowing}/>\n                </Card>\n            </div>\n            <MemoList userList={followings} symbol={<CloseCircleOutlined />} action={deleteFollowing}/>\n        </Card>\n    )\n}\n\nexport default Followings;\n"]},"metadata":{},"sourceType":"module"}