{"ast":null,"code":"import _toConsumableArray from\"/Users/willwang98/Rice Homework/final-frontend-WillWang1998/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/Users/willwang98/Rice Homework/final-frontend-WillWang1998/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/willwang98/Rice Homework/final-frontend-WillWang1998/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/willwang98/Rice Homework/final-frontend-WillWang1998/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{memo,useEffect,useState}from\"react\";import{Card,Divider,Input,List,message,Space}from\"antd\";import Article from\"./Article\";import SubmitOrEditArticle from\"./SubmitOrEditArticle\";import{showBackendMessage,stringArrayEqual}from\"../util/Functions\";import EventBus from\"../util/EventBus\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Articles=function Articles(){message.config({rtl:false});var _useState=useState([]),_useState2=_slicedToArray(_useState,2),selectedArticleIds=_useState2[0],setSelectedArticleIds=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),username=_useState4[0],setUsername=_useState4[1];var load=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"http://localhost:4000/search/article\",{method:\"POST\",credentials:\"include\"}).then(function(res){if(res.ok){showBackendMessage();return res.json();}else{throw res.statusText;}}).then(function(res){setUsername(res.username);setSelectedArticleIds(function(selectedArticleIds){return res.ids;});}).catch(function(err){return message.error(err,1);});case 2:case\"end\":return _context.stop();}}},_callee);}));return function load(){return _ref.apply(this,arguments);};}();useEffect(function(){return load();},[]);EventBus.addEventListener(\"reload_articles\",load);var onSearch=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(value){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(\"http://localhost:4000/search/article\",{method:\"POST\",credentials:\"include\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({keyWord:value})}).then(function(res){if(res.ok){showBackendMessage();return res.json();}else{throw res.statusText;}}).then(function(res){setSelectedArticleIds(function(selectedArticleIds){return res.ids;});}).catch(function(err){return message.error(err,1);});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function onSearch(_x){return _ref2.apply(this,arguments);};}();var onSubmitArticle=function onSubmitArticle(id){setSelectedArticleIds(function(selectedArticleIds){return[id].concat(_toConsumableArray(selectedArticleIds));});};var onDeleteArticle=function onDeleteArticle(id){setSelectedArticleIds(function(selectedArticleIds){return selectedArticleIds.filter(function(item){return item!==id;});});};var ArticleList=function ArticleList(props){return/*#__PURE__*/_jsx(List,{itemLayout:\"vertical\",size:\"large\",dataSource:props.selectedArticleIds,renderItem:function renderItem(item){return/*#__PURE__*/_jsx(Article,{id:item,username:username,deleteAction:onDeleteArticle});},pagination:{position:\"top\",pageSize:5}});};var areEqualArticleList=function areEqualArticleList(prevProps,nextProps){return stringArrayEqual(prevProps.selectedArticleIds,nextProps.selectedArticleIds);};/*#__PURE__*/memo(ArticleList,areEqualArticleList);return/*#__PURE__*/_jsxs(Space,{direction:\"vertical\",style:{width:\"100%\"},children:[/*#__PURE__*/_jsx(SubmitOrEditArticle,{action:onSubmitArticle}),/*#__PURE__*/_jsxs(Card,{bordered:true,children:[/*#__PURE__*/_jsx(Input.Search,{allowClear:true,enterButton:\"Search\",size:\"large\",onSearch:onSearch}),/*#__PURE__*/_jsx(Divider,{orientation:\"left\",children:\"Posts\"}),/*#__PURE__*/_jsx(ArticleList,{selectedArticleIds:selectedArticleIds})]})]});};export default Articles;","map":{"version":3,"sources":["/Users/willwang98/Rice Homework/final-frontend-WillWang1998/src/component/Articles.js"],"names":["React","memo","useEffect","useState","Card","Divider","Input","List","message","Space","Article","SubmitOrEditArticle","showBackendMessage","stringArrayEqual","EventBus","Articles","config","rtl","selectedArticleIds","setSelectedArticleIds","username","setUsername","load","fetch","method","credentials","then","res","ok","json","statusText","ids","catch","err","error","addEventListener","onSearch","value","headers","body","JSON","stringify","keyWord","onSubmitArticle","id","onDeleteArticle","filter","item","ArticleList","props","position","pageSize","areEqualArticleList","prevProps","nextProps","width"],"mappings":"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","sourcesContent":["import React, {memo, useEffect, useState} from \"react\";\nimport {Card, Divider, Input, List, message, Space} from \"antd\";\nimport Article from \"./Article\";\nimport SubmitOrEditArticle from \"./SubmitOrEditArticle\";\nimport {showBackendMessage, stringArrayEqual} from \"../util/Functions\";\nimport EventBus from \"../util/EventBus\";\n\nconst Articles = () => {\n    message.config({\n        rtl: false,\n    });\n\n    const [selectedArticleIds, setSelectedArticleIds] = useState([]);\n    const [username, setUsername] = useState(\"\");\n\n    const load = async () => {\n        await fetch(\"http://localhost:4000/search/article\", {\n            method: \"POST\",\n            credentials: \"include\",\n        }).then(res => {\n            if (res.ok) {\n                showBackendMessage();\n                return res.json();\n            } else {\n                throw res.statusText;\n            }\n        }).then(res => {\n            setUsername(res.username);\n            setSelectedArticleIds(selectedArticleIds => res.ids);\n        }).catch(err => message.error(err, 1));\n    }\n\n    useEffect(() => load(), []);\n    EventBus.addEventListener(\"reload_articles\", load);\n    const onSearch = async (value) => {\n        await fetch(\"http://localhost:4000/search/article\", {\n            method: \"POST\",\n            credentials: \"include\",\n            headers: {\n                \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify({\n                keyWord: value,\n            })\n        }).then(res => {\n            if (res.ok) {\n                showBackendMessage();\n                return res.json();\n            } else {\n                throw res.statusText;\n            }\n        }).then(res => {\n            setSelectedArticleIds(selectedArticleIds => res.ids);\n        }).catch(err => message.error(err, 1));\n    }\n\n    const onSubmitArticle = (id) => {\n        setSelectedArticleIds(selectedArticleIds => [id, ...selectedArticleIds]);\n    }\n\n    const onDeleteArticle = (id) => {\n        setSelectedArticleIds(selectedArticleIds => selectedArticleIds.filter((item) => item !== id));\n    }\n\n    const ArticleList = (props) => {\n        return (\n            <List\n                itemLayout=\"vertical\"\n                size=\"large\"\n                dataSource={props.selectedArticleIds}\n                renderItem={item => <Article id={item} username={username} deleteAction={onDeleteArticle}/>}\n                pagination={{\n                    position: \"top\",\n                    pageSize: 5\n                }}\n            />\n        );\n    }\n\n    const areEqualArticleList = (prevProps, nextProps) => {\n        return stringArrayEqual(prevProps.selectedArticleIds, nextProps.selectedArticleIds);\n    }\n\n    memo(ArticleList, areEqualArticleList);\n\n    return (\n        <Space direction=\"vertical\" style={{width: \"100%\"}}>\n            <SubmitOrEditArticle action={onSubmitArticle}/>\n\n            <Card bordered={true}>\n                <Input.Search\n                    allowClear\n                    enterButton=\"Search\"\n                    size=\"large\"\n                    onSearch={onSearch}\n                />\n                <Divider orientation=\"left\">Posts</Divider>\n                <ArticleList selectedArticleIds={selectedArticleIds}/>\n            </Card>\n        </Space>\n    )\n}\n\nexport default Articles;\n"]},"metadata":{},"sourceType":"module"}