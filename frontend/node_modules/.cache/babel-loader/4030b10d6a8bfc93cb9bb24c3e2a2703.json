{"ast":null,"code":"import _regeneratorRuntime from\"/Users/willwang98/Rice Homework/final-frontend-WillWang1998/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/willwang98/Rice Homework/final-frontend-WillWang1998/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/willwang98/Rice Homework/final-frontend-WillWang1998/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{memo,useEffect,useState}from\"react\";import{Input,Button,Form,Card,Divider,message}from\"antd\";import{showBackendMessage,stringArrayEqual}from\"../util/Functions\";import ImagesWall from\"./ImageWall\";// TODO: React.lazy\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SubmitOrEditArticle=function SubmitOrEditArticle(props){message.config({rtl:false});var _Form$useForm=Form.useForm(),_Form$useForm2=_slicedToArray(_Form$useForm,1),form=_Form$useForm2[0];var _useState=useState(props.imageUrlsList),_useState2=_slicedToArray(_useState,2),imageUrlsList=_useState2[0],setImageUrlsList=_useState2[1];useEffect(function(){form.setFieldsValue({\"title\":props.title,\"text\":props.text});setImageUrlsList(function(imageUrlsList){return props.imageUrlsList;});},[form,props]);var onFinish=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!props.id){_context.next=5;break;}_context.next=3;return fetch(\"https://comp531-rw48-mymedia-backend.herokuapp.com/article/\"+props.id,{method:\"PUT\",credentials:\"include\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({title:values.title,text:values.text,images:imageUrlsList})}).then(function(res){if(res.ok){showBackendMessage();return res.json();}else{throw res.statusText;}}).then(function(res){message.success(\"Edit Successfully\");props.action({id:res._id,title:res.title,text:res.text,timestamp:res.timestamp,images:res.images});}).catch(function(err){return message.error(err,1);});case 3:_context.next=7;break;case 5:_context.next=7;return fetch(\"https://comp531-rw48-mymedia-backend.herokuapp.com/article\",{method:\"POST\",credentials:\"include\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({title:values.title,text:values.text,images:imageUrlsList})}).then(function(res){if(res.ok){showBackendMessage();return res.json();}else{throw res.statusText;}}).then(function(res){message.success(\"Submit Successfully\",1);props.action(res._id);}).catch(function(err){return message.error(err,1);});case 7:case\"end\":return _context.stop();}}},_callee);}));return function onFinish(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Card,{bordered:true,children:[/*#__PURE__*/_jsx(Divider,{orientation:\"left\",children:props.id?\"Edit this article\":\"Add new article\"}),/*#__PURE__*/_jsxs(Form,{onFinish:onFinish,form:form,children:[/*#__PURE__*/_jsx(Form.Item,{name:\"title\",children:/*#__PURE__*/_jsx(Input,{})}),/*#__PURE__*/_jsx(Form.Item,{name:\"text\",children:/*#__PURE__*/_jsx(Input.TextArea,{})}),/*#__PURE__*/_jsx(Form.Item,{children:/*#__PURE__*/_jsx(ImagesWall,{imageUrlsList:imageUrlsList,action:setImageUrlsList})}),/*#__PURE__*/_jsxs(Form.Item,{children:[/*#__PURE__*/_jsx(Button,{style:{width:\"50%\"},htmlType:\"submit\",type:\"primary\",children:\"Submit\"}),/*#__PURE__*/_jsx(Button,{style:{width:\"50%\"},htmlType:\"reset\",type:\"default\",children:\"Clear\"})]})]})]});};var areEqualSubmitOrEditArticle=function areEqualSubmitOrEditArticle(prevProps,nextProps){return prevProps.id===nextProps.id&&prevProps.title===nextProps.title&&prevProps.text===nextProps.text&&stringArrayEqual(prevProps.imageUrlsList,nextProps.imageUrlsList);};export default/*#__PURE__*/memo(SubmitOrEditArticle,areEqualSubmitOrEditArticle);","map":{"version":3,"sources":["/Users/willwang98/Rice Homework/final-frontend-WillWang1998/src/component/SubmitOrEditArticle.js"],"names":["React","memo","useEffect","useState","Input","Button","Form","Card","Divider","message","showBackendMessage","stringArrayEqual","ImagesWall","SubmitOrEditArticle","props","config","rtl","useForm","form","imageUrlsList","setImageUrlsList","setFieldsValue","title","text","onFinish","values","id","fetch","method","credentials","headers","body","JSON","stringify","images","then","res","ok","json","statusText","success","action","_id","timestamp","catch","err","error","width","areEqualSubmitOrEditArticle","prevProps","nextProps"],"mappings":"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","sourcesContent":["import React, {memo, useEffect, useState} from \"react\";\nimport {Input, Button, Form, Card, Divider, message} from \"antd\";\nimport {showBackendMessage, stringArrayEqual} from \"../util/Functions\";\nimport ImagesWall from \"./ImageWall\";\n\n\n// TODO: React.lazy\nconst SubmitOrEditArticle = (props) => {\n    message.config({\n        rtl: false,\n    });\n    const [form] = Form.useForm();\n    const [imageUrlsList, setImageUrlsList] = useState(props.imageUrlsList);\n\n    useEffect(() => {\n        form.setFieldsValue({\n            \"title\": props.title,\n            \"text\": props.text,\n        });\n        setImageUrlsList(imageUrlsList => props.imageUrlsList);\n    }, [form, props]);\n\n    const onFinish = async (values) => {\n        if (props.id) {\n            await fetch(\"https://comp531-rw48-mymedia-backend.herokuapp.com/article/\" + props.id, {\n                method: \"PUT\",\n                credentials: \"include\",\n                headers: {\"Content-Type\": \"application/json\"},\n                body: JSON.stringify({\n                    title: values.title,\n                    text: values.text,\n                    images: imageUrlsList,\n                }),\n            }).then(res => {\n                if (res.ok) {\n                    showBackendMessage();\n                    return res.json();\n                } else {\n                    throw res.statusText;\n                }\n            }).then(res => {\n                message.success(\"Edit Successfully\");\n                props.action({\n                    id: res._id,\n                    title: res.title,\n                    text: res.text,\n                    timestamp: res.timestamp,\n                    images: res.images,\n                });\n            }).catch(err => message.error(err, 1));\n        } else {\n            await fetch(\"https://comp531-rw48-mymedia-backend.herokuapp.com/article\", {\n                method: \"POST\",\n                credentials: \"include\",\n                headers: {\"Content-Type\": \"application/json\"},\n                body: JSON.stringify({\n                    title: values.title,\n                    text: values.text,\n                    images: imageUrlsList,\n                }),\n            }).then(res => {\n                if (res.ok) {\n                    showBackendMessage();\n                    return res.json();\n                } else {\n                    throw res.statusText;\n                }\n            }).then(res => {\n                message.success(\"Submit Successfully\", 1);\n                props.action(res._id);\n            }).catch(err => message.error(err, 1));\n        }\n    }\n\n    return (\n        <Card bordered={true}>\n            <Divider orientation=\"left\">{\n                props.id ? \"Edit this article\" : \"Add new article\"\n            }</Divider>\n            <Form onFinish={onFinish} form={form}>\n                <Form.Item name=\"title\">\n                    <Input/>\n                </Form.Item>\n                <Form.Item name=\"text\">\n                    <Input.TextArea/>\n                </Form.Item>\n                <Form.Item>\n                    <ImagesWall\n                        imageUrlsList={imageUrlsList}\n                        action={setImageUrlsList} />\n                </Form.Item>\n                <Form.Item>\n                    <Button style={{width: \"50%\"}} htmlType=\"submit\" type=\"primary\">\n                        Submit\n                    </Button>\n                    <Button style={{width: \"50%\"}} htmlType=\"reset\" type=\"default\">\n                        Clear\n                    </Button>\n                </Form.Item>\n            </Form>\n        </Card>\n    )\n}\n\nconst areEqualSubmitOrEditArticle = (prevProps, nextProps) => {\n    return prevProps.id === nextProps.id\n        && prevProps.title === nextProps.title\n        && prevProps.text === nextProps.text\n        && stringArrayEqual(prevProps.imageUrlsList, nextProps.imageUrlsList);\n}\n\nexport default memo(SubmitOrEditArticle, areEqualSubmitOrEditArticle);\n"]},"metadata":{},"sourceType":"module"}