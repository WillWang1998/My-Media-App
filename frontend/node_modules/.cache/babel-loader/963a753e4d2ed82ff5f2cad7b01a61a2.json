{"ast":null,"code":"import _createForOfIteratorHelper from\"/Users/willwang98/Rice Homework/final-frontend-WillWang1998/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"/Users/willwang98/Rice Homework/final-frontend-WillWang1998/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/willwang98/Rice Homework/final-frontend-WillWang1998/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/willwang98/Rice Homework/final-frontend-WillWang1998/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";// TODO: The wall is using a \"stack\", need to become \"array(vector).\"\nimport React,{useState}from\"react\";import{PlusOutlined}from\"@ant-design/icons\";import{Modal,Upload}from\"antd\";import EventBus from\"../util/EventBus\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var getBase64=function getBase64(file){return new Promise(function(resolve,reject){var reader=new FileReader();reader.readAsDataURL(file);reader.onload=function(){return resolve(reader.result);};reader.onerror=function(error){return reject(error);};});};var ImagesWall=function ImagesWall(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),previewVisible=_useState2[0],setPreviewVisible=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),previewImage=_useState4[0],setPreviewImage=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),previewTitle=_useState6[0],setPreviewTitle=_useState6[1];var _useState7=useState(props.imageUrlsList?props.imageUrlsList.map(function(item){var fileName=item.split(\"/\").slice(-1)[0];var fileUid=fileName.split(\".\").slice(0,-1).join(\"\");return{uid:fileUid,name:fileName,status:'done',url:item};}):[]),_useState8=_slicedToArray(_useState7,2),fileList=_useState8[0],setFileList=_useState8[1];var handleCancel=function handleCancel(){setPreviewVisible(false);};var handlePreview=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(file){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(!file.url&&!file.preview)){_context.next=4;break;}_context.next=3;return getBase64(file.originFileObj);case 3:file.preview=_context.sent;case 4:setPreviewImage(file.url||file.preview);setPreviewVisible(true);setPreviewTitle(file.name||file.url.substring(file.url.lastIndexOf('/')+1));case 7:case\"end\":return _context.stop();}}},_callee);}));return function handlePreview(_x){return _ref.apply(this,arguments);};}();var handleChange=function handleChange(_ref2){var fileList=_ref2.fileList;setFileList(fileList);console.log(\"fileList\",fileList);var fileListStatus=[];fileList.forEach(function(item){return fileListStatus.push(item.status);});if(fileListStatus.every(function(item){return item===\"done\";})){var curImageUrlsList=[];var _iterator=_createForOfIteratorHelper(fileList),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var file=_step.value;curImageUrlsList.push(file.url||file.response.url);}}catch(err){_iterator.e(err);}finally{_iterator.f();}console.log(\"curImageUrlsList\",curImageUrlsList);props.action(function(imageUrlsList){return curImageUrlsList;});}};var uploadButton=/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(PlusOutlined,{}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:8},children:\"Upload\"})]});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Upload,{name:\"image\",action:\"http://localhost:4000/upload/image\",withCredentials:true,listType:\"picture-card\",fileList:fileList,onPreview:handlePreview,onChange:handleChange,children:fileList.length>=8?null:uploadButton}),/*#__PURE__*/_jsx(Modal,{visible:previewVisible,title:previewTitle,footer:null,onCancel:handleCancel,children:/*#__PURE__*/_jsx(\"img\",{alt:\"example\",style:{width:'100%'},src:previewImage})})]});};export default ImagesWall;","map":{"version":3,"sources":["/Users/willwang98/Rice Homework/final-frontend-WillWang1998/src/component/ImageWall.js"],"names":["React","useState","PlusOutlined","Modal","Upload","EventBus","getBase64","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","error","ImagesWall","props","previewVisible","setPreviewVisible","previewImage","setPreviewImage","previewTitle","setPreviewTitle","imageUrlsList","map","item","fileName","split","slice","fileUid","join","uid","name","status","url","fileList","setFileList","handleCancel","handlePreview","preview","originFileObj","substring","lastIndexOf","handleChange","console","log","fileListStatus","forEach","push","every","curImageUrlsList","response","action","uploadButton","marginTop","length","width"],"mappings":"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","sourcesContent":["// TODO: The wall is using a \"stack\", need to become \"array(vector).\"\nimport React, {useState} from \"react\";\nimport {PlusOutlined} from \"@ant-design/icons\";\nimport {Modal, Upload} from \"antd\";\nimport EventBus from \"../util/EventBus\";\n\n\nconst getBase64 = (file) => {\n    return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.readAsDataURL(file);\n        reader.onload = () => resolve(reader.result);\n        reader.onerror = error => reject(error);\n    });\n}\n\nconst ImagesWall = (props) => {\n    const [previewVisible, setPreviewVisible] = useState(false);\n    const [previewImage, setPreviewImage] = useState(\"\");\n    const [previewTitle, setPreviewTitle] = useState(\"\");\n    const [fileList, setFileList] = useState(\n        props.imageUrlsList ?\n            props.imageUrlsList.map((item) => {\n                let fileName = item.split(\"/\").slice(-1)[0];\n                let fileUid = fileName.split(\".\").slice(0, -1).join(\"\");\n                return {\n                    uid: fileUid,\n                    name: fileName,\n                    status: 'done',\n                    url: item,\n                }\n            }) :\n            []\n    );\n\n    const handleCancel = () => {\n        setPreviewVisible(false);\n    }\n\n    const handlePreview = async (file) => {\n        if (!file.url && !file.preview) {\n            file.preview = await getBase64(file.originFileObj);\n        }\n        setPreviewImage(file.url || file.preview);\n        setPreviewVisible(true);\n        setPreviewTitle(\n            file.name || file.url.substring(file.url.lastIndexOf('/') + 1),\n        );\n    };\n\n    const handleChange = ({ fileList }) => {\n        setFileList(fileList);\n        console.log(\"fileList\", fileList);\n        let fileListStatus = [];\n        fileList.forEach(item => fileListStatus.push(item.status));\n        if (fileListStatus.every(item => item === \"done\")) {\n            let curImageUrlsList = [];\n            for (let file of fileList) {\n                curImageUrlsList.push(file.url || file.response.url);\n            }\n            console.log(\"curImageUrlsList\", curImageUrlsList);\n            props.action(imageUrlsList => curImageUrlsList);\n        }\n    };\n\n    const uploadButton = (\n        <div>\n            <PlusOutlined />\n            <div style={{ marginTop: 8 }}>Upload</div>\n        </div>\n    );\n\n    return (\n        <>\n            <Upload\n                name=\"image\"\n                action=\"http://localhost:4000/upload/image\"\n                withCredentials={true}\n                listType=\"picture-card\"\n                fileList={fileList}\n                onPreview={handlePreview}\n                onChange={handleChange}\n            >\n                {fileList.length >= 8 ? null : uploadButton}\n            </Upload>\n            <Modal\n                visible={previewVisible}\n                title={previewTitle}\n                footer={null}\n                onCancel={handleCancel}\n            >\n                <img alt=\"example\" style={{ width: '100%' }} src={previewImage} />\n            </Modal>\n        </>\n    );\n};\n\nexport default ImagesWall;\n"]},"metadata":{},"sourceType":"module"}